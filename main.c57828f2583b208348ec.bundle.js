(()=>{"use strict";class t{constructor(t,i){this.sprite={coor:{x:0,y:102},width:2404,height:28,scale:.5},this.canvasLocation={x:t,y:i}}draw(t){this.tex||(this.tex=t.loadImageAndCreateTextureInfo("./assets/images/trex-sprites.png")),t.draw(this.tex,this.sprite.coor.x,this.sprite.coor.y,this.sprite.width,this.sprite.height,this.canvasLocation.x,this.canvasLocation.y,this.sprite.width*this.sprite.scale,this.sprite.height*this.sprite.scale)}update(){this.canvasLocation.x-=5,this.canvasLocation.y-=0}getDisplayLocation(){return this.canvasLocation}getDisplayWidth(){return this.sprite.width*this.sprite.scale}getDisplayHeight(){return this.sprite.height*this.sprite.scale}}class i{constructor(t,i){this.spriteList=[],this.spriteList.push({coor:{x:1516,y:4},width:82,height:90,scale:.5}),this.spriteList.push({coor:{x:1604,y:4},width:82,height:90,scale:.5}),this.spriteList.push({coor:{x:1868,y:38},width:114,height:56,scale:.5}),this.spriteList.push({coor:{x:1986,y:38},width:114,height:56,scale:.5}),this.canvasLocation={x:t,y:i},this.lastTime=window.performance.now(),this.speed=200,this.isDuck=!1,this.firstFrame=!0}draw(t){var i;this.tex||(this.tex=t.loadImageAndCreateTextureInfo("./assets/images/trex-sprites.png")),i=this.isDuck?this.firstFrame?this.spriteList[2]:this.spriteList[3]:this.firstFrame?this.spriteList[0]:this.spriteList[1],t.draw(this.tex,i.coor.x,i.coor.y,i.width,i.height,this.canvasLocation.x,this.canvasLocation.y,i.width*i.scale,i.height*i.scale)}update(){var t=window.performance.now();t-this.lastTime>this.speed&&(this.lastTime=t,this.firstFrame=!this.firstFrame)}}var s={translation:function(t,i,s){return[1,0,0,0,0,1,0,0,0,0,1,0,t,i,s,1]},xRotation:function(t){var i=Math.cos(t),s=Math.sin(t);return[1,0,0,0,0,i,s,0,0,-s,i,0,0,0,0,1]},yRotation:function(t){var i=Math.cos(t),s=Math.sin(t);return[i,0,-s,0,0,1,0,0,s,0,i,0,0,0,0,1]},zRotation:function(t){var i=Math.cos(t),s=Math.sin(t);return[i,s,0,0,-s,i,0,0,0,0,1,0,0,0,0,1]},scaling:function(t,i,s){return[t,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1]},translate:function(t,i,e,r){return s.multiply(t,s.translation(i,e,r))},xRotate:function(t,i){return s.multiply(t,s.xRotation(i))},yRotate:function(t,i){return s.multiply(t,s.yRotation(i))},zRotate:function(t,i){return s.multiply(t,s.zRotation(i))},scale:function(t,i,e,r){return s.multiply(t,s.scaling(i,e,r))},multiply:function(t,i){var s=i[0],e=i[1],r=i[2],a=i[3],h=i[4],o=i[5],n=i[6],g=i[7],l=i[8],c=i[9],u=i[10],d=i[11],p=i[12],x=i[13],f=i[14],m=i[15],L=t[0],R=t[1],w=t[2],A=t[3],_=t[4],v=t[5],T=t[6],E=t[7],y=t[8],F=t[9],D=t[10],B=t[11],U=t[12],I=t[13],b=t[14],S=t[15];return[s*L+e*_+r*y+a*U,s*R+e*v+r*F+a*I,s*w+e*T+r*D+a*b,s*A+e*E+r*B+a*S,h*L+o*_+n*y+g*U,h*R+o*v+n*F+g*I,h*w+o*T+n*D+g*b,h*A+o*E+n*B+g*S,l*L+c*_+u*y+d*U,l*R+c*v+u*F+d*I,l*w+c*T+u*D+d*b,l*A+c*E+u*B+d*S,p*L+x*_+f*y+m*U,p*R+x*v+f*F+m*I,p*w+x*T+f*D+m*b,p*A+x*E+f*B+m*S]},projection:function(t,i,s){return[2/t,0,0,0,0,-2/i,0,0,0,0,2/s,0,-1,1,0,1]},orthographic:function(t,i,s,e,r,a){return[2/(i-t),0,0,0,0,2/(e-s),0,0,0,0,2/(r-a),0,(t+i)/(t-i),(s+e)/(s-e),(r+a)/(r-a),1]}};function e(t,i,s){var e=t.createShader(i);if(t.shaderSource(e,s),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS))return e;console.log(t.getShaderInfoLog(e)),t.deleteShader(e)}class r{constructor(t){this.gl=t.getContext("webgl"),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.vertexSource="\nattribute vec4 a_position;\nattribute vec2 a_texcoord;\n\nuniform mat4 u_matrix;\nuniform mat4 u_textureMatrix;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n    gl_Position = u_matrix * a_position;\n    v_texcoord = (u_textureMatrix * vec4(a_texcoord, 0, 1)).xy;\n}\n",this.fragmentSource="\nprecision mediump float;\n\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_texcoord);\n}\n";var i=e(this.gl,this.gl.VERTEX_SHADER,this.vertexSource),s=e(this.gl,this.gl.FRAGMENT_SHADER,this.fragmentSource);this.program=function(t,i,s){var e=t.createProgram();if(t.attachShader(e,i),t.attachShader(e,s),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS))return e;console.log(t.getProgramInfoLog(e)),t.deleteProgram(e)}(this.gl,i,s),this.positionLocation=this.gl.getAttribLocation(this.program,"a_position"),this.texcoordLocation=this.gl.getAttribLocation(this.program,"a_texcoord"),this.matrixLocation=this.gl.getUniformLocation(this.program,"u_matrix"),this.textureMatrixLocation=this.gl.getUniformLocation(this.program,"u_textureMatrix"),this.textureLocation=this.gl.getUniformLocation(this.program,"u_texture"),this.positionBuffer=this.gl.createBuffer(),this.texcoordBuffer=this.gl.createBuffer()}loadImageAndCreateTextureInfo(t){var i=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR);var s={width:1,height:1,texture:i},e=new Image;return e.addEventListener("load",(t=>{s.width=e.width,s.height=e.height,this.gl&&(this.gl.bindTexture(this.gl.TEXTURE_2D,s.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e))})),e.src=t,s}draw(t,i,s,e,r,a,h,o,n){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texcoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),this.gl.STATIC_DRAW);var g={x:110,y:110,dx:1,dy:1,textureInfo:t};(l=this).gl&&l.drawImage(g.textureInfo.texture,g.textureInfo.width,g.textureInfo.height,i,s,e,r,a,h,o,n);var l=this}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}drawImage(t,i,e,r,a,h,o,n,g,l,c){if(this.gl){this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.useProgram(this.program),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texcoordBuffer),this.gl.enableVertexAttribArray(this.texcoordLocation),this.gl.vertexAttribPointer(this.texcoordLocation,2,this.gl.FLOAT,!1,0,0);var u=s.orthographic(0,this.gl.canvas.width,this.gl.canvas.height,0,-1,1);u=s.translate(u,n,g,0),u=s.scale(u,l,c,1),this.gl.uniformMatrix4fv(this.matrixLocation,!1,u);var d=s.translation(r/i,a/e,0);d=s.scale(d,h/i,o/e,1),this.gl.uniformMatrix4fv(this.textureMatrixLocation,!1,d),this.gl.uniform1i(this.textureLocation,0),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}drawPolygons(t,i){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.viewport(0,0,window.innerWidth,window.innerHeight),this.gl.useProgram(this.program),this.gl.uniform2f(this.resolutionUniformLocation,window.innerWidth,window.innerHeight),this.gl.uniform4f(this.colorUniformLocation,1,0,i,1),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.drawArrays(this.gl.TRIANGLES,0,3)}}class a{constructor(){this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.drawer=new r(this.canvas),this.groundList=[],this.groundList.push(new t(0,400));var s=this.groundList[0].getDisplayLocation(),e=Math.ceil(this.groundList[0].getDisplayWidth());this.groundList.push(new t(s.x+e,400)),s=this.groundList[1].getDisplayLocation(),e=Math.ceil(this.groundList[1].getDisplayWidth()),this.groundList.push(new t(s.x+e,400)),this.TRex=new i(50,370)}update(){this.groundList.forEach((t=>{t.update()}));var i=this.groundList[0].getDisplayLocation(),s=Math.ceil(this.groundList[0].getDisplayWidth());i.x+s<0&&(this.groundList.shift(),i=this.groundList[1].getDisplayLocation(),s=Math.ceil(this.groundList[1].getDisplayWidth()),this.groundList.push(new t(i.x+s,400))),this.TRex.update()}render(){this.drawer.clear(),this.groundList.forEach((t=>{t.draw(this.drawer)})),this.TRex.draw(this.drawer),document.body.appendChild(this.canvas)}}(new class{constructor(){this.canvaView=new a}update(){this.canvaView.update()}render(){this.canvaView.render()}loop(){this.update(),this.render(),requestAnimationFrame((()=>this.loop()))}run(){requestAnimationFrame((()=>this.loop()))}}).run()})();